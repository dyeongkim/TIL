# 운영체제/OperatingSystem
## 2. 프로세스 관리
### 2.1 프로세스의 개념 및 상태
> 프로세스(Process)란 실행중에 있는 프로그램(Program)   

프로세스는 다음과 같은 요소를 포함한다.
- 메모리
    - 프로세스가 실행되기 위해 필요한 코드, 데이터 및 스택 공간을 저장

- 프로세스 제어 블록(Process Control Block. PCB)
    - 프로세스의 상태, 프로세스 ID, 프로그램 카운터, 레지스터 값, 메모리 정보, 입출력 상태 등 프로세스와 관련된 모든 정보를 포함

- 스레드
    - 프로세스 내에서 실행되는 독립적인 실행 단위
    - 한 프로세스 내의 여러 스레드는 코드, 데이터 및 메모리 공간을 공유

#### 프로세스 상태

![프로세스_상태전이도](https://user-images.githubusercontent.com/113990279/229357084-ddc1160f-8e50-4b94-82a2-07ee5f076a1d.png)

(출처 : IT위키)
- *New*
    - 프로세스가 생성되어 시스템에 등록되는 상태
    - 메모리에 할당되지 않음

- *Ready*
    - 프로세스가 메모리에 할당되어 CPU를 기다리는 상태
    - 스케줄러에 의해 CPU를 할당받기를 기다림

- *Running*
    - CPU를 할당받아 명령어를 실행하는 상태

- *Waiting*
    - 입출력 작업이나 다른 프로세스의 결과를 기다리는 상태
    - CPU를 할당받지 않으며, 필요한 작업이 완료되면 다시 *Ready*상태로 돌아감

- *Terminated*
    - 실행을 완료하거나 중단된 상태
    - 시스템에서 제거되고 사용하던 자원을 회수

### 2.2 프로세스 스케줄링 알고리즘
- FCFS(First Conme First Served)
    - 프로세스가 도착한 순서대로 CPU를 할당
    - 공평하고 이해하기 쉬운 알고리즘
    - 짧은 작업이 긴 작업 뒤에 대기하는 경우 평균 대기 시간이 길어질 수 있다.(콘보이 효과/convoy effect)

- SJF(Shortest Job First)
    - 프로세스의 예상 실행 시간을 고려하여 가장 짧은 작업부터 CPU를 할당
    - 평균 대기 시간이 최소화 되는 알고리즘
    - 실행 시간을 정확히 예측하기 어렵다.

- 우선순위 스케줄링
    - 각 프로세스에 우선순위를 부여하여 높은 우선순위의 프로세스부터 CPU를 할당
    - 중요한 작업을 먼저 처리할 수 있다.
    - 낮은 우선순위의 프로세스가 계속 대기하는 상태가 발생 할 수 있다.(기아상태)

- Round Robin
    - 각 프로세스에 고정된 시간 단위(타임 퀀텀) 동안 CPU를 순환하며 할당
    - 공평한 CPU 할당이 가능
    - 다양한 길이의 프로세스에 적합
    - 타임 퀀텀 설정에 따라 성능이 크게 영향받을 수 있음.

### 2.3 프로세스 동기화
여러 프로세스 또는 스레드가 공유 자원에 동시에 접근하려고 할 때 발생하는 문제를 해결하기 위한 기법.

- 임계 구역 문제(Critical Section Problem)
    - 여러 프로세스가 공유 데이터에 접근할 때 발생하는 문제.
    - 데이터 불일치, 경쟁 상태 등의 문제가 발생
    - 해결을 위해 임계 구역이라는 코드 영역을 정의하고, 한 번에 하나의 프로세스만 영역을 실행 할 수 있도록 제한.
    - 상호 배제(Mutual Exclusion), 진행(Progress), 한정된 대기(Bounded Waiting)을 만족하는 것.
        - 상호 배제 : 오직 한 스레드만 진입할 수 있다.
        - 진행 : 스레드의 진입 유무는 유한 시간내에 결정된다.
        - 한정된 대기 : 어느 스레드든지 유한 시간 내에 임계구역 안에 들어갈 수 있다.

#### 프로세스 동기화 기법
임계 구역 문제를 해결하기 위한 동기화 기법

- 세마포어 (Semaphore)
    - 프로세스 간 동기화를 위한 추상 데이터 타입으로, 정수 값을 가지며 두 가지 원자적 연산인 wait()와 signal()로 구성.
    - 세마포어는 공유 자원의 개수를 나타내며, wait() 연산은 세마포어 값을 감소, signal()연산은 증가 시킴
    - 세마포어 값이 음수가 되면 프로세스는 대기 상태로 전환되고, 다른 프로세스가 signal()을 호출할 때까지 기다림.
    - 계수 세마포어(Counting semaphore)와 이진 세마포어로 나뉜다.
        - 계수 세마포어 
            - 초기값은 가능한 자원 수로 정해지며, 세마포어 값의 범위는 정해져 있지 않다.
        - 이진 세마포어 
            - 세마포어 값으로 0,1을 갖는다. 
            - 계수 세마포어보다 간단히 구현 가능하다.
            - 하드웨어가 지원하는 기능을 이용하여 구현하기도 한다. 
            - 이진 세마포어를 이용하여 계수 세마포어를 구현할 수 있다.
            - 상호 배제를 위한 동기화 도구로 사용할 수 있다.

- 뮤텍스(Mutex)
    - 상호 배제를 위한 동기화 도구로, 한 번에 하나의 프로세스만 공유 자원에 접근 할 수 있도록 한다.
    - 뮤텍스는 Lock, Unlock 두 가지 연산으로 구성
    - 프로세스가 뮤텍스를 잠그면 공유 자원에 접근할 수 있고, 다른 프로세스는 대기 상태로 전환.
    - 작업이 완료되면 뮤텍스를 풀어 다른 프로세스가 접근 할 수 있도록 한다.
    
뮤텍스와 세마포어 차이점

- 뮤텍스는 소유권 개념이 있어서 설정한 프로세스만이 잠금을 해제
- 이진 세마포어는 어떤 프로세스든 잠금을 해제할 수 있다.

> 뮤텍스는 상호 배제를 보장하는 동기화 도구로 선호되며, 세마포어는 다수의 공유자원에 대한 동기화에 적합.
        
#### 컨텍스트 스위칭
> CPU가 한 프로세스 실행에서 다른 프로세스로 전활할 때 발생

컨텍스트 전환 중에 운영 체제는 현재 프로세스의 상태(레지스터 값, 프로그램 카운터 등)를 저장하고 실행할 다음 프로세스의 상태를 복원

#### IPC(프로세스 간 통신)
> 프로세스 간의 데이터 및 신호 교환, 이를 통해 프로세스는 리소스를 조정하고 공유할 수 있다.

- 파이프(Pipes)
    - 데이터가 프로세스 간에 흐를 수 있도록 하는 단방향 통신 채널

- 메시지 큐(Message Queues)
    - 프로세스 간에 메시지를 저장하고 전송하는 데 사용되는 데이터 구조

- 공유 메모리(Shared Memory)
    - 여러 프로세스가 동일한 메모리 영역에 액세스하여 메시지 전달 없이 직접 데이터를 교환할 수 있도록 하는 기술

- 세마포어(Semaphores)
    - 공유 리소스에 대한 액세스를 조정하고 프로세스 간의 상호 배제를 보장하는 데 사용되는 동기화 프리미티브